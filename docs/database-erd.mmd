erDiagram
    %% ==========================================
    %% USUARIOS E EMPRESAS
    %% ==========================================

    usuarios {
        bigint id PK
        string nome
        string email UK
        string senha
        timestamp email_verificado_em
        bigint empresa_id FK
        timestamp criado_em
        timestamp atualizado_em
    }

    empresas {
        bigint id PK
        string nome
        string documento
        string email
        string telefone
        string endereco
        string cidade
        string estado
        string cep
        timestamp criado_em
        timestamp atualizado_em
    }

    %% ==========================================
    %% BANCOS E CONTAS
    %% ==========================================

    bancos {
        bigint id PK
        string nome
        string codigo
        string icone
        boolean ativo
        timestamp criado_em
        timestamp atualizado_em
    }

    contas_bancarias {
        bigint id PK
        bigint empresa_id FK
        bigint banco_id FK
        string nome
        string agencia
        string numero_conta
        string tipo
        decimal saldo_inicial
        decimal saldo_atual
        boolean ativo
        timestamp criado_em
        timestamp atualizado_em
    }

    %% ==========================================
    %% CARTOES DE CREDITO
    %% ==========================================

    cartoes_credito {
        bigint id PK
        bigint empresa_id FK
        bigint conta_bancaria_id FK
        string nome
        string ultimos_digitos
        decimal limite
        integer dia_fechamento
        integer dia_vencimento
        boolean ativo
        timestamp criado_em
        timestamp atualizado_em
    }

    faturas {
        bigint id PK
        bigint cartao_credito_id FK
        date data_referencia
        date data_fechamento
        date data_vencimento
        decimal valor
        string status
        timestamp criado_em
        timestamp atualizado_em
    }

    %% ==========================================
    %% CATEGORIAS E CENTROS DE CUSTO
    %% ==========================================

    categorias {
        bigint id PK
        bigint empresa_id FK
        bigint categoria_pai_id FK
        string nome
        string tipo
        string cor
        string icone
        boolean ativo
        timestamp criado_em
        timestamp atualizado_em
    }

    centros_custo {
        bigint id PK
        bigint empresa_id FK
        string nome
        string descricao
        boolean ativo
        timestamp criado_em
        timestamp atualizado_em
    }

    %% ==========================================
    %% CLIENTES E FORNECEDORES
    %% ==========================================

    clientes {
        bigint id PK
        bigint empresa_id FK
        string nome
        string documento
        string email
        string telefone
        string endereco
        string cidade
        string estado
        string cep
        text observacoes
        boolean ativo
        timestamp criado_em
        timestamp atualizado_em
    }

    fornecedores {
        bigint id PK
        bigint empresa_id FK
        string nome
        string documento
        string email
        string telefone
        string endereco
        string cidade
        string estado
        string cep
        text observacoes
        boolean ativo
        timestamp criado_em
        timestamp atualizado_em
    }

    %% ==========================================
    %% LANCAMENTOS
    %% ==========================================

    lancamentos {
        bigint id PK
        bigint empresa_id FK
        bigint categoria_id FK
        bigint conta_bancaria_id FK
        bigint centro_custo_id FK
        bigint cliente_id FK
        bigint fornecedor_id FK
        bigint fatura_id FK
        bigint recorrencia_id FK
        string tipo
        string descricao
        decimal valor
        date data_vencimento
        date data_pagamento
        string status
        text observacoes
        string anexo
        timestamp criado_em
        timestamp atualizado_em
    }

    %% ==========================================
    %% RECORRENCIAS
    %% ==========================================

    recorrencias {
        bigint id PK
        bigint empresa_id FK
        bigint categoria_id FK
        bigint conta_bancaria_id FK
        bigint centro_custo_id FK
        bigint cliente_id FK
        bigint fornecedor_id FK
        string tipo
        string descricao
        decimal valor
        integer dia_vencimento
        string frequencia
        date data_inicio
        date data_fim
        boolean ativo
        timestamp criado_em
        timestamp atualizado_em
    }

    %% ==========================================
    %% TRANSFERENCIAS
    %% ==========================================

    transferencias {
        bigint id PK
        bigint empresa_id FK
        bigint conta_origem_id FK
        bigint conta_destino_id FK
        decimal valor
        date data_transferencia
        text observacoes
        timestamp criado_em
        timestamp atualizado_em
    }

    %% ==========================================
    %% ORCAMENTO E METAS
    %% ==========================================

    orcamentos {
        bigint id PK
        bigint empresa_id FK
        bigint categoria_id FK
        integer ano
        integer mes
        decimal valor_planejado
        timestamp criado_em
        timestamp atualizado_em
    }

    metas {
        bigint id PK
        bigint empresa_id FK
        bigint conta_bancaria_id FK
        string nome
        decimal valor_alvo
        decimal valor_atual
        date data_alvo
        string status
        timestamp criado_em
        timestamp atualizado_em
    }

    %% ==========================================
    %% RELACIONAMENTOS
    %% ==========================================

    empresas ||--o{ usuarios : "tem"
    empresas ||--o{ contas_bancarias : "tem"
    empresas ||--o{ cartoes_credito : "tem"
    empresas ||--o{ categorias : "tem"
    empresas ||--o{ centros_custo : "tem"
    empresas ||--o{ clientes : "tem"
    empresas ||--o{ fornecedores : "tem"
    empresas ||--o{ lancamentos : "tem"
    empresas ||--o{ recorrencias : "tem"
    empresas ||--o{ transferencias : "tem"
    empresas ||--o{ orcamentos : "tem"
    empresas ||--o{ metas : "tem"

    bancos ||--o{ contas_bancarias : "tem"

    contas_bancarias ||--o{ lancamentos : "tem"
    contas_bancarias ||--o{ recorrencias : "tem"
    contas_bancarias ||--o{ cartoes_credito : "paga"
    contas_bancarias ||--o{ metas : "destino"
    contas_bancarias ||--o{ transferencias : "origem"
    contas_bancarias ||--o{ transferencias : "destino"

    cartoes_credito ||--o{ faturas : "tem"
    faturas ||--o{ lancamentos : "tem"

    categorias ||--o{ categorias : "subcategoria"
    categorias ||--o{ lancamentos : "tem"
    categorias ||--o{ recorrencias : "tem"
    categorias ||--o{ orcamentos : "tem"

    centros_custo ||--o{ lancamentos : "tem"
    centros_custo ||--o{ recorrencias : "tem"

    clientes ||--o{ lancamentos : "receitas"
    clientes ||--o{ recorrencias : "fixas"

    fornecedores ||--o{ lancamentos : "despesas"
    fornecedores ||--o{ recorrencias : "fixas"

    recorrencias ||--o{ lancamentos : "gera"
